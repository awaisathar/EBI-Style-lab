{{#markdown}}
*What is this, exactly?* The EMBL-EBI Style Lab has guidance on how and what should be used to build visually and textually compliant EMBL-EBI websites, documents, and texts. It's partly about reinforcing our shared identity, but it's mostly about leveraging the best tools to build things faster and with fewer bugs, errors, and user experience issues.

{{/markdown}}

<div class="callout">
<span class="label padding-left-large">Contents of the EMBL-EBI Style Lab</span>
<div class="medium-up-3 clearfix">
<div class="column">
  {{#markdown}}
  ### Universal principals
  - [Our basic style guide]({{root}}general)
  - [Writing guidance]({{root}}general/writing)
  - [EMBL-EBI Logos]({{root}}general/templates)
  - [Social media guidelines]({{root}}general/social)
  {{/markdown}}
</div>
<div class="column">
  {{#markdown}}
  ### Create documents
  - [Microsoft Word and PowerPoint templates]({{root}}general/templates)
  - [Poster templates]({{root}}general/templates)
  - [Fonts &amp; icons]({{root}}general/fonts)

  {{/markdown}}
</div>
<div class="column">
  {{#markdown}}
  ### Build websites
  - [How to get started with the EBI Visual Framework]({{root}}websites)
  - [How to use the EBI Icon fonts on a website]({{root}}general/fonts)
  - [Boilerplate templates to get started]({{root}}websites/sample-site/)
  - [Reusable patterns]({{root}}websites/patterns)
    - [Add a new pattern]({{root}}websites/patterns/howto)
  {{/markdown}}
</div>
</div>
</div>

<span class="label padding-left-large">What's happening</span>

<div class="medium-up-3">
<div class="column">
  {{#markdown}}
  ### What's being discussed
  {{/markdown}}
  <div id="github-issues"><cite>Loading...</cite></div>
  <a href="https://github.com/ebiwd/EBI-Style-lab/issues" class="readmore">View all discussions</a>
</div>
<div class="column">
  {{#markdown}}
  ### What's new
  {{/markdown}}
  <div id="github-commits"><cite>Loading...</cite></div>
  <a href="https://github.com/ebiwd/EBI-Style-lab/commits/master" class="readmore">View all updates</a>
</div>
</div>

{{#markdown}}

---

#### Developer?
If you're a web developer that wants to build atop this platform, <a href="https://github.com/ebiwd/EBI-Style-lab/#ebi-style-lab" class="readmore">see the github readme</a>
{{/markdown}}

{{{{raw}}}}

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.8/handlebars.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
<!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/locale/en-gb.js"></script> -->
<script tryp="text/javascript">
document.addEventListener('DOMContentLoaded', function(){
  var DateFormats = {
         short: " DD MMMM",
         long: "dddd DD.MM.YYYY HH:mm"
  };
  Handlebars.registerHelper("formatDate", function(datetime, format) {
    if (moment) {
      // can use other formats like 'lll' too
      format = DateFormats[format] || format;
      return moment(datetime).format(format);
    }
    else {
      return datetime;
    }
  });

  var commitTemplate = '{{#each this}}'+
      '<div class="padding-bottom-small">'+
        '<h6 class="margin-bottom-none"><a href="{{link.href}}" target="_blank" class="">{{title}}</a></h6>'+
        '<span class="label  secondary-color">by {{author.name}} on {{formatDate updated "short"}}</span>'+
        // '<span class="label"></span>'+
      '</div>'+
    '{{/each}}';

  var issueTemplate = '{{#each item}}'+
      '<div class="padding-bottom-small">'+
        '<h6 class="margin-bottom-none"><a href="{{link}}" target="_blank" class="">{{title}}</a></h6>'+
        '<span class="label  secondary-color">{{formatDate pubDate "short"}}</span>'+
        // '<span class="label"></span>'+
      '</div>'+
    '{{/each}}';

  // feed processor
  function feedImporter(feedUrl,template,destination){
    this.feedUrl = feedUrl;
    this.template = template;
    this.destination = destination;
  }
  feedImporter.prototype.initAtom = function(){
    function queryData(properties) {
      $.ajax({
        // here we use YQL to translate the RSS into JSON, but you could easily pass in your JSON here
        url: 'https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20atom%20where%20url%3D%22'+ encodeURIComponent(properties.feedUrl)+'%22limit%206&&format=json&diagnostics=false&_maxage=3600',
        template:    properties.template,
        destination: properties.destination
      }).done( function(data) {
        // here you need to map your JSON structure
        var mappedData = data.query.results.entry,
            template = Handlebars.compile(properties.template);
        $(properties.destination).html(template(mappedData));
      });
    }
    queryData(this); // bootstrap
  }
  feedImporter.prototype.initRSS = function(){
    function queryData(properties) {
      $.ajax({
        // here we use YQL to translate the RSS into JSON, but you could easily pass in your JSON here
        url: 'https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20rss%20where%20url%3D%22'+ encodeURIComponent(properties.feedUrl)+'%22limit%206&&format=json&diagnostics=false&_maxage=3600',
        // url: 'https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%feed%20where%20url%3D%22'+ encodeURIComponent(properties.feedUrl)+'%22limit%206&&format=json&diagnostics=false&_maxage=3600',
        template:    properties.template,
        destination: properties.destination
      }).done( function(data) {
        // here you need to map your JSON structure
        // console.log(data.query.results);
        var mappedData = data.query.results,
            template = Handlebars.compile(properties.template);
        $(properties.destination).html(template(mappedData));
      });
    }
    queryData(this); // bootstrap
  }
  var githubCommits = new feedImporter("https://github.com/ebiwd/EBI-Style-lab/commits/master.atom",commitTemplate, "#github-commits").initAtom();
  var githubIssues = new feedImporter("https://zapier.com/engine/rss/2403632/stylelab-issues",issueTemplate, "#github-issues").initRSS();


}, false);

</script>
{{{{/raw}}}}
